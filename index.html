<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Quiz Interactif Excel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      body {
        margin: 0;
        padding: 0;
        background: linear-gradient(135deg, #74ebd5 0%, #acb6e5 100%);
        font-family: 'Segoe UI', Arial, sans-serif;
        min-height: 100vh;
      }
      .quiz-container {
        background: #fff;
        max-width: 440px;
        margin: 40px auto 0 auto;
        padding: 35px 30px 30px 30px;
        border-radius: 20px;
        box-shadow: 0 12px 32px rgba(122,143,209,0.20);
        text-align: center;
        position: relative;
        animation: popIn 0.7s;
      }
      @keyframes popIn {
        0% {transform:scale(0.93);}
        100% {transform:scale(1);}
      }
      .quiz-header-img {
        width: 90px;
        margin-bottom: 2px;
        margin-top:-10px;
        border-radius: 12px;
        box-shadow: 0 4px 14px #d7dbec85;
        background: #fff;
      }
      .quiz-title {
        font-size: 1.45rem;
        color: #4566af;
        margin-bottom: 10px;
      }
      .progress {
        height: 7px;
        width: 90%;
        background: #e9ecf6;
        border-radius: 5px;
        margin: 15px auto 18px auto;
        overflow: hidden;
      }
      .progress-bar {
        height: 7px;
        background: linear-gradient(90deg,#3993db 50%,#86e8b2 100%);
        width: 0;
        border-radius: 5px;
        transition: width 0.55s cubic-bezier(.68,-0.55,.27,1.55);
      }
      .question {
        font-weight: bold;
        color: #1c3658;
        margin-bottom: 24px;
        font-size: 1.10rem;
      }
      .choice {
        background: #f6f9fd;
        border: 2px solid #dfecfa;
        border-radius: 10px;
        padding: 13px 12px;
        margin: 8px 0;
        font-size: 1rem;
        cursor: pointer;
        text-align: left;
        transition: background 0.3s, border 0.2s;
        outline: none;
        display: block;
        width: 100%;
        font-family: inherit;
      }
      .choice.selected, .choice:hover {
        border: 2.5px solid #3993db;
        background: #f1faff;
      }
      .choice.correct {
        background: #daf6de;
        border-color: #32b872;
        color: #227946;
      }
      .choice.incorrect {
        background: #ffe4e4;
        border-color: #f24843;
        color: #a42423;
      }
      .button-group {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        margin-top: 10px;
        margin-bottom: -8px;
      }
      #prevBtn, #nextBtn {
        flex: 1 1 0;
        padding: 10px 0;
        background: linear-gradient(90deg,#86e8b2 20%,#3993db 70%);
        color: #fff;
        font-weight: bold;
        font-size: 1rem;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.25s;
        box-shadow: 0 2px 8px #e0eafc55;
      }
      #prevBtn {
        background: linear-gradient(90deg, #f7d358 10%, #f96c6c 80%);
      }
      #nextBtn:disabled, #prevBtn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }
      #score {
        font-size: 1.3rem;
        font-weight: 600;
        color: #227946;
        margin-top: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 14px;
      }
      .score-emoji {
        font-size: 2.3rem;
      }
      @media (max-width: 600px) {
        .quiz-container {
          max-width: 97%;
          padding: 15px 4vw 22px 4vw;
        }
        .quiz-header-img {
          width: 55px;
        }
        .quiz-title {
          font-size: 1.10rem;
        }
        #score {
          font-size: 1.1rem;
        }
      }
    </style>
</head>
<body>
<div class="quiz-container">
    <!-- Ton logo (remplace src par le bon lien si tu le changes) -->
    <img src="HB.png" class="quiz-header-img" alt="Logo Artisan Data">
    <div class="quiz-title">Quiz sur les Fonctions Excel</div>
    <div class="progress">
       <div class="progress-bar" id="progressBar"></div>
    </div>
    <div id="quiz">
        <div id="question" class="question"></div>
        <div id="choices"></div>
        <div class="button-group">
          <button id="prevBtn">Pr√©c√©dent</button>
          <button id="nextBtn" disabled>Suivant</button>
        </div>
        <div id="score"></div>
    </div>
</div>
<script>
const questions = [
    {
        question: "Q1 ‚Äì Quelle fonction permet de filtrer dynamiquement une plage de donn√©es selon un crit√®re ?",
        choices: ["A) CHOISIRCOLS", "B) TRIER", "C) FILTRE", "D) UNIQUE"],
        answer: 2
    },
    {
        question: "Q2 ‚Äì Quelle combinaison permet de nommer une cellule de fa√ßon √† ce qu‚Äôelle s‚Äôadapte en glissant verticalement ?",
        choices: ["A) $A$2", "B) Feuil2!$A$2", "C) Feuil2!$A2", "D) A$2"],
        answer: 2
    },
    {
        question: "Q3 ‚Äì Quelle formule permet de cr√©er une fonction personnalis√©e dans Excel ?",
        choices: ["A) LET", "B) NOMMER", "C) LAMBDA", "D) ADRESSE"],
        answer: 2
    },
    {
        question: "Q4 ‚Äì La fonction NB.JOURS.OUVRES.INTL permet de :",
        choices: [
            "A) Compter uniquement les jours ouvrables du lundi au vendredi",
            "B) Compter les jours ouvr√©s avec des week-ends personnalis√©s",
            "C) Compter les jours de cong√© uniquement",
            "D) Compter les jours f√©ri√©s selon un pays"
        ],
        answer: 1
    },
    {
        question: "Q5 ‚Äì Quelle syntaxe permet de mettre en forme conditionnellement une ligne enti√®re si une cellule contient ‚ÄúURGENT‚Äù ?",
        choices: [
            "A) =$A1=\"URGENT\"",
            "B) =A1=\"URGENT\"",
            "C) =$A$1=\"URGENT\"",
            "D) =SI(A1=\"URGENT\")"
        ],
        answer: 0
    },
    {
        question: "Q6 ‚Äì √Ä quoi sert la fonction ADRESSE(2;3) ?",
        choices: [
            "A) Donne la valeur de la cellule B2",
            "B) Donne l‚Äôadresse sous forme de texte de la cellule ligne 2, colonne 3",
            "C) Renvoie une cellule vide",
            "D) Cr√©e une adresse mail"
        ],
        answer: 1
    },
    {
        question: "Q7 ‚Äì Laquelle de ces fonctions est nouvelle avec Excel 365 ?",
        choices: [
            "A) CONCATENER",
            "B) STXT",
            "C) JOINDRE.TEXTE",
            "D) TEXTE"
        ],
        answer: 2
    }
];

let currentQuestion = 0;
let score = 0;
let userChoices = Array(questions.length).fill(null);
let answered = false;

const questionEl = document.getElementById("question");
const choicesEl = document.getElementById("choices");
const nextBtn = document.getElementById("nextBtn");
const prevBtn = document.getElementById("prevBtn");
const scoreEl = document.getElementById("score");
const progressBar = document.getElementById("progressBar");

function updateProgress() {
    progressBar.style.width = ((currentQuestion) / questions.length * 100) + "%";
}
function emojiForScore(rate) {
    if (rate === 1) return "üéâ";
    if (rate >= 0.85) return "üëè";
    if (rate >= 0.65) return "üòä";
    if (rate >= 0.4) return "üôÇ";
    return "üìö";
}
function loadQuestion() {
    nextBtn.disabled = userChoices[currentQuestion] === null;
    prevBtn.disabled = currentQuestion === 0;
    scoreEl.textContent = "";
    let q = questions[currentQuestion];
    questionEl.textContent = q.question;
    choicesEl.innerHTML = "";
    answered = false;
    q.choices.forEach((choice, i) => {
        let btn = document.createElement("button");
        btn.textContent = choice;
        btn.className = "choice";
        if(userChoices[currentQuestion] !== null){
            btn.classList.add('selected');
            if (i === questions[currentQuestion].answer) btn.classList.add('correct');
            if (i !== questions[currentQuestion].answer && i === userChoices[currentQuestion]) btn.classList.add('incorrect');
        }
        btn.onclick = function() {
            document.querySelectorAll('.choice').forEach(c => c.classList.remove('selected'));
            btn.classList.add('selected');
            userChoices[currentQuestion] = i;
            nextBtn.disabled = false;
            // Feedback visuel si r√©pondu
            document.querySelectorAll('.choice').forEach((b, j)=>{
              b.classList.remove('correct','incorrect');
              if(userChoices[currentQuestion]!==null){
                if(j===q.answer) b.classList.add('correct');
                if(j!==q.answer && j === userChoices[currentQuestion]) b.classList.add('incorrect');
              }
            });
        };
        choicesEl.appendChild(btn);
    });
    // pr√©-selection si existant
    if (userChoices[currentQuestion] !== null) {
        document.querySelectorAll('.choice')[userChoices[currentQuestion]].classList.add('selected');
        answered = true;
    }
    updateProgress();
}

nextBtn.addEventListener('click', () => {
    // ne majore le score que lors du dernier √©cran
    if(userChoices[currentQuestion] === null){ return; }
    if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        loadQuestion();
    } else {
        // Calcul du score total
        let finalScore = userChoices.reduce((acc, val, idx)=> (val === questions[idx].answer ? acc+1 : acc),0);
        questionEl.textContent = "Quiz termin√© !";
        choicesEl.innerHTML = "";
        nextBtn.style.display = "none";
        prevBtn.style.display = "none";
        progressBar.style.width = "100%";
        const rate = finalScore/questions.length;
        scoreEl.innerHTML = `<span class="score-emoji">${emojiForScore(rate)}</span> <span>Votre score : ${finalScore} / ${questions.length}</span>`;
    }
});

prevBtn.addEventListener('click', () => {
    if (currentQuestion > 0) {
        currentQuestion--;
        loadQuestion();
    }
});
loadQuestion();
</script>
</body>
</html>
