<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>D√©fi Excel : Ma√Ætrisez les 30 Jours en Quiz !</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body {
    margin: 0; padding: 0;
    background: linear-gradient(135deg,#74ebd5 0%,#acb6e5 100%);
    font-family:'Segoe UI',Arial,sans-serif;
    min-height:100vh;
  }
  .quiz-container {
    background: #fff;
    max-width: 480px;
    margin: 70px auto 70px auto;
    padding: 35px 30px 30px 30px;
    border-radius: 20px;
    box-shadow: 0 12px 32px rgba(122,143,209,0.20);
    text-align: center;
    position: relative;
    animation: popIn 0.7s;
  }
  @keyframes popIn { 
    0%{transform:scale(0.93);} 
    100%{transform:scale(1);} 
  }
  .logo-box {
    position: absolute;
    top: 5px; /* remont√© de 13px par rapport √† avant */
    left: 18px;
    width: 84px; height: 84px;
    display: flex;
    align-items: flex-start;
    background: none;
    z-index: 10;
  }
  .logo-box img {
    width: 80px;
    height: 80px;
    border-radius: 14px;
    box-shadow: 0 2px 12px rgba(184,200,226,0.33);
    object-fit: contain;
    background: transparent; /* fond transparent */
  }
  .spacer-logo { height: 54px; }
  
  .quiz-header {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 6px;
    margin-bottom: 8px;
  }
  .quiz-title {
    font-size: 1.45rem;
    color: #4566af;
    margin: 0;
    font-weight: 700;
  }
  /* Barre progress √©motion / emoji sous le titre */
  .quiz-steps {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    font-size: 1.1em;
    color: #3b6ab8;
    font-weight: 600;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    user-select: none;
  }
  .quiz-steps span {
    display: flex;
    align-items: center;
  }
  .emoji-flag, .emoji-finish {
    font-size: 1.6em;
  }
  .quiz-steps .dot {
    width: 9px;
    height: 9px;
    background-color: #3993db;
    border-radius: 50%;
    display: inline-block;
    transition: background-color 0.4s ease;
  }
  .quiz-steps .dot.active {
    background-color: #86e8b2;
  }

  .progress {
    height: 7px;
    width: 90%;
    background: #e9ecf6;
    border-radius: 5px;
    margin: 15px auto 18px auto;
    overflow: hidden;
  }
  .progress-bar {
    height: 7px;
    background: linear-gradient(90deg,#3993db 50%,#86e8b2 100%);
    width: 0;
    border-radius: 5px;
    transition: width 0.55s cubic-bezier(.68,-0.55,.27,1.55);
  }
  .question {
    font-weight: bold;
    color: #1c3658;
    margin-bottom: 14px;
    font-size: 1.12rem;
    min-height: 64px;
  }
  .choices-container {
    text-align: left;
    margin: 0 auto 15px;
    max-width: 430px;
  }
  button.choice {
    background: #f6f9fd;
    border: 2px solid #dfecfa;
    border-radius: 10px;
    padding: 12px 14px;
    margin: 10px 0;
    font-size: 1rem;
    cursor: pointer;
    transition: background 0.3s, border 0.2s;
    outline: none;
    width: 100%;
    text-align: left;
    font-family: inherit;
  }
  button.choice.selected,
  button.choice:hover {
    border: 2.5px solid #3993db;
    background: #f1faff;
  }
  .button-group {
    display: flex;
    justify-content: space-between;
    gap: 10px;
    margin-top: 12px;
    margin-bottom: -6px;
  }
  #prevBtn, #nextBtn, #retryBtn {
    flex: 1 1 0;
    padding: 10px 0;
    background: linear-gradient(90deg,#86e8b2 20%,#3993db 70%);
    color: #fff;
    font-weight: bold;
    font-size: 1rem;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.25s;
    box-shadow: 0 2px 8px #e0eafc55;
  }
  #prevBtn {
    background: linear-gradient(90deg,#f7d358 10%,#f96c6c 80%);
  }
  #nextBtn:disabled, #prevBtn:disabled, #retryBtn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
  #score {
    font-size: 1.3rem;
    font-weight: 600;
    color: #227946;
    margin-top: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 14px;
  }
  #fun-msg {
    font-size: 1rem;
    font-weight: 500;
    margin-top: 14px;
    margin-left: auto;
    margin-right: auto;
    color: #227946;
    padding-bottom: 10px;
    text-align: center;
    min-height: 50px;
  }
  .score-emoji {
    font-size: 2.3rem;
  }
  .explanation-box {
    background: #fefefe;
    color: #222222;
    padding: 16px 20px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.08);
    border-radius: 12px;
    font-size: 1rem;
    line-height: 1.5;
    max-width: 100%;
    word-break: break-word;
    margin-top: 10px;
    text-align: left;
  }
  #showExplanationBtn {
    display: none;
    margin-top: 8px;
    background: #4178d2;
    color: white;
    border: none;
    border-radius: 25px;
    padding: 10px 28px;
    cursor: pointer;
    font-weight: 600;
    font-size: 1rem;
    box-shadow: 0 5px 12px rgba(65, 120, 210, 0.6);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    user-select: none;
  }
  #showExplanationBtn:hover {
    background: #2a57a4;
    box-shadow: 0 8px 20px rgba(42, 87, 164, 0.8);
  }
  #showExplanationBtn:focus {
    outline: 3px solid #7fb3ff;
    outline-offset: 3px;
  }
  @media(max-width:650px) {
    .quiz-container {
      max-width: 97%;
      padding: 12vw 2vw 8vw 2vw;
      margin-top: 76px;
      margin-bottom: 50px;
    }
    .logo-box {
      top: 3px; /* responsive ajust√© l√©g√®rement */
      left: 7px;
      width: 48px;
      height: 48px;
    }
    .logo-box img {
      width: 44px;
      height: 44px;
    }
    .spacer-logo {
      height: 29px;
    }
  }
</style>
</head>
<body>
<div class="quiz-container" role="main" aria-label="Quiz Excel S√©rie 30 jours">
  <div class="logo-box" aria-hidden="true">
    <img src="HB.png" alt="Logo HB Artisan Data" />
  </div>
  <div class="spacer-logo"></div>
  <div class="quiz-header">
    <h1 class="quiz-title" id="quizTitle">üéØ D√©fi Excel : Ma√Ætrisez les 30 Jours en Quiz ! üéâ</h1>
    <div class="quiz-steps" aria-hidden="true" id="quizSteps">
      <span class="emoji-flag" aria-label="D√©part">üö©</span>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="emoji-finish" aria-label="Arriv√©e">üèÅ</span>
    </div>
  </div>
  <div class="progress" aria-hidden="true">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  <div id="quiz" aria-live="polite" aria-atomic="true">
    <div id="question" class="question" tabindex="0">Chargement...</div>
    <div class="choices-container" id="choices"></div>
    <button id="showExplanationBtn" aria-label="Afficher l'explication" type="button">Voir l'explication</button>
    <div class="explanation-box" id="explanation" style="display:none;"></div>
    <div class="button-group">
      <button id="prevBtn" aria-label="Question pr√©c√©dente" type="button">Pr√©c√©dent</button>
      <button id="nextBtn" disabled aria-label="Question suivante" type="button">Suivant</button>
    </div>
  </div>
  <div id="score" aria-live="polite" aria-atomic="true"></div>
  <div id="fun-msg"></div>
</div>

<script>
  const questionsOrig = [
    {
      question: "Quelle fonctionnalit√© Excel permet de filtrer dynamiquement une plage selon un crit√®re ?",
      choices: ["CHOISIRCOLS", "TRIER", "FILTRE", "UNIQUE"],
      answer: 2,
      explanation: "üí° <b>La fonction FILTRE</b> permet d‚Äôextraire des donn√©es selon un ou plusieurs crit√®res, pour cr√©er des listes dynamiques et actualis√©es."
    },
    {
      question: "Quel symbole dans une r√©f√©rence Excel indique une r√©f√©rence absolue de cellule ?",
      choices: ["$A$1", "A1", "A$1", "$A1"],
      answer: 0,
      explanation: `‚úÖ Le signe <b>$</b> devant la lettre fixe la colonne (r√©f√©rence absolue sur colonne).<br>
                    ‚úÖ Le signe <b>$</b> devant le chiffre fixe la ligne (r√©f√©rence absolue sur ligne).<br>
                    ‚úÖ <b>$A$1</b> fixe √† la fois la ligne et la colonne.<br>
                    Ces r√©f√©rences sont utilis√©es pour verrouiller la position des cellules lors d'une recopie ou un glissement de formule.`
    },
    {
      question: "Que permet la fonction SI dans Excel ?",
      choices: ["Effectuer un test logique et renvoyer une valeur selon vrai/faux", "Faire une somme conditionnelle", "Filtrer des donn√©es", "Formater une cellule"],
      answer: 0,
      explanation: "üîç La fonction SI teste une condition logique et renvoie une valeur si elle est vraie, une autre si elle est fausse."
    },
    {
      question: "Comment s√©curiser une cellule Excel pour emp√™cher sa modification tout en laissant d‚Äôautres cellules modifiables ?",
      choices: [
        "Prot√©ger toute la feuille sans d√©verrouiller aucune cellule",
        "D√©verrouiller les cellules modifiables, puis prot√©ger la feuille",
        "Verrouiller les cellules √† modifier et prot√©ger le classeur",
        "Mettre un mot de passe sur le fichier sans prot√©ger la feuille"
      ],
      answer: 1,
      explanation: "üí° Excel verrouille les cellules par d√©faut, mais c‚Äôest la protection de la feuille qui entraine leur verrouillage. D√©verrouille d‚Äôabord les cellules modifiables avant de prot√©ger la feuille."
    },
    {
      question: "Quelle fonctionnalit√© permet de g√©rer plusieurs filtres interactifs li√©s pour un tableau de bord dynamique ?",
      choices: ["Formules matricielles", "Segments et chronologies", "Mise en forme conditionnelle", "Validation de donn√©es"],
      answer: 1,
      explanation: "‚úÖ Les segments et chronologies permettent de filtrer plusieurs tableaux crois√©s dynamiques et graphiques de mani√®re synchronis√©e et intuitive."
    },
    {
      question: "Quelle m√©thode permet de mettre √† jour automatiquement un graphique Excel dans PowerPoint ?",
      choices: [
        "Copier-coller simple",
        "Exporter au format image",
        "Collage sp√©cial avec liaison",
        "Exporter en PDF"
      ],
      answer: 2,
      explanation: "üí° Le collage sp√©cial avec liaison cr√©e un lien dynamique, qui met √† jour automatiquement les graphiques dans PowerPoint."
    },
    {
      question: "Quelle est la fonction d‚Äôune formule NOMM√âE dans Excel ?",
      choices: [
        "Cr√©er une variable pour une plage/valeur r√©utilisable",
        "Mettre en forme conditionnelle une cellule",
        "Calculer la moyenne d‚Äôune plage",
        "Prot√©ger une cellule"
      ],
      answer: 0,
      explanation: "üîç Nommer une plage ou une valeur permet de simplifier les formules et de rendre le fichier plus clair et facile √† maintenir."
    },
    {
      question: "Quelle est la meilleure pratique pour organiser un classeur contenant un tableau de bord ?",
      choices: [
        "Mettre TCD, graphiques et segments tous m√©lang√©s sur une m√™me feuille",
        "D√©dier une feuille aux graphiques dynamiques avec les segments plac√©s √† c√¥t√©, et une autre feuille aux TCD",
        "Mettre tous les √©l√©ments dans une feuille cach√©e",
        "Ne pas utiliser de segments"
      ],
      answer: 1,
      explanation: "‚úÖ Pour une organisation optimale, regroupe les graphiques dynamiques et leurs segments sur une m√™me feuille pour un filtrage visuel intuitif, et place les TCD dans une feuille s√©par√©e pour un tableau de bord clair."
    },
    {
      question: "Que prot√®ge la fonction \"Prot√©ger la structure du classeur\" dans Excel ?",
      choices: [
        "Les donn√©es dans les cellules",
        "Le contenu des macros VBA",
        "L‚Äôajout, suppression ou d√©placement des feuilles",
        "Le formatage conditionnel"
      ],
      answer: 2,
      explanation: "üí° Cette protection bloque les modifications de la structure : ajout, suppression ou d√©placement des feuilles."
    },
    {
      question: "Quelle est la limite d‚Äôune protection par mot de passe √† l‚Äôouverture d‚Äôun fichier Excel ?",
      choices: [
        "Le fichier reste modifiable m√™me prot√©g√©",
        "Le mot de passe est impossible √† r√©cup√©rer en cas d‚Äôoubli",
        "Le mot de passe peut √™tre facilement devin√©",
        "Il prot√®ge uniquement les macros"
      ],
      answer: 1,
      explanation: "‚ö†Ô∏è Attention : en cas d‚Äôoubli du mot de passe √† l‚Äôouverture, le fichier devient inaccessible sans possibilit√© de r√©cup√©ration."
    }
  ];

  let questions;
  let currentQuestion = 0;
  let userChoices = [];
  let answered = false;

  const questionEl = document.getElementById("question");
  const choicesEl = document.getElementById("choices");
  const nextBtn = document.getElementById("nextBtn");
  const prevBtn = document.getElementById("prevBtn");
  const scoreEl = document.getElementById("score");
  const progressBar = document.getElementById("progressBar");
  const funMsgEl = document.getElementById("fun-msg");
  const explanationEl = document.getElementById("explanation");
  const showExplanationBtn = document.getElementById("showExplanationBtn");
  const quizStepsEl = document.getElementById("quizSteps");
  const dots = Array.from(quizStepsEl.querySelectorAll(".dot"));

  function shuffleArray(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }

  function shuffleQuestionsChoices() {
    questions = questionsOrig.map(q => {
      let qCopy = {
        question: q.question,
        choices: [...q.choices],
        answer: q.answer,
        explanation: q.explanation
      };
      const correctText = qCopy.choices[qCopy.answer];
      shuffleArray(qCopy.choices);
      qCopy.answer = qCopy.choices.indexOf(correctText);
      return qCopy;
    });
  }

  function updateDots(current) {
    dots.forEach((dot, i) => {
      if (i < current) {
        dot.classList.add("active");
      } else {
        dot.classList.remove("active");
      }
    });
  }

  function loadQuestion() {
    answered = false;
    explanationEl.style.display = "none";
    showExplanationBtn.style.display = "none";
    nextBtn.disabled = true;
    scoreEl.textContent = "";
    funMsgEl.textContent = "";
    let q = questions[currentQuestion];
    questionEl.textContent = `Q${currentQuestion + 1} / ${questions.length} ‚Äì ${q.question}`;
    choicesEl.innerHTML = "";

    q.choices.forEach((choice, i) => {
      let btn = document.createElement("button");
      btn.className = "choice";
      btn.textContent = choice;
      btn.setAttribute("tabindex","0");
      btn.onclick = function() {
        if (answered) return;
        document.querySelectorAll(".choice").forEach(c => c.classList.remove("selected"));
        btn.classList.add("selected");
        userChoices[currentQuestion] = i;
        nextBtn.disabled = false;
        showExplanationBtn.style.display = "inline-block";
      };
      choicesEl.appendChild(btn);
    });

    if (userChoices[currentQuestion] !== null && userChoices[currentQuestion] !== undefined) {
      let prevSelected = choicesEl.children[userChoices[currentQuestion]];
      if (prevSelected) prevSelected.classList.add("selected");
      nextBtn.disabled = false;
      showExplanationBtn.style.display = "inline-block";
    }

    prevBtn.disabled = currentQuestion === 0;
    updateProgress();
    updateDots(currentQuestion);
  }

  function updateProgress() {
    progressBar.style.width = ((currentQuestion) / questions.length) * 100 + "%";
  }

  function showExplanation() {
    if (answered) return;
    answered = true;
    const q = questions[currentQuestion];
    explanationEl.innerHTML = q.explanation;
    explanationEl.style.display = "block";

    [...choicesEl.children].forEach((btn, idx) => {
      btn.disabled = true;
      if (idx === q.answer) {
        btn.style.borderColor = "#32b37a";
        btn.style.fontWeight = "bold";
      } else if (userChoices[currentQuestion] === idx) {
        btn.style.borderColor = "#e75252";
        btn.style.textDecoration = "line-through";
      }
    });

    if (currentQuestion === questions.length - 1) {
      showScore();
    }
  }

  function showScore() {
    let correctCount = userChoices.reduce((acc, val, idx) => val === questions[idx].answer ? acc + 1 : acc, 0);
    const total = questions.length;
    const rate = correctCount / total;
    progressBar.style.width = "100%";

    let emoji = "üìö";
    let msg = "Ce n‚Äôest que le d√©but! Continue de progresser! üöÄ";
    if (rate === 1) {
      emoji = "üéâ";
      msg = "Bravo, score parfait ! Tu es le boss d'Excel ! ü•≥";
    } else if (rate >= 0.7) {
      emoji = "üëè";
      msg = "Beau boulot ! Tu ma√Ætrises bien le sujet ! üí™";
    } else if (rate >= 0.5) {
      emoji = "üôÇ";
      msg = "Pas mal, mais tu peux faire encore mieux ! ü§ó";
    }

    scoreEl.innerHTML = `<span class="score-emoji">${emoji}</span> <span>Score final : ${correctCount} / ${total}</span>`;
    funMsgEl.textContent = msg;

    const retryBtn = document.createElement("button");
    retryBtn.id = "retryBtn";
    retryBtn.textContent = "Recommencer le quiz";
    retryBtn.style.margin = "22px auto 0 auto";
    retryBtn.style.background = "linear-gradient(90deg,#34e194 10%,#3582e8 80%)";
    retryBtn.style.color = "#fff";
    retryBtn.style.fontWeight = "bold";
    retryBtn.style.fontSize = "1rem";
    retryBtn.style.padding = "12px 0";
    retryBtn.style.border = "none";
    retryBtn.style.borderRadius = "8px";
    retryBtn.style.cursor = "pointer";
    retryBtn.style.display = "block";
    retryBtn.style.maxWidth = "200px";

    retryBtn.onclick = () => {
      shuffleQuestionsChoices();
      userChoices = Array(questions.length).fill(null);
      currentQuestion = 0;
      loadQuestion();
      scoreEl.textContent = "";
      funMsgEl.textContent = "";
      explanationEl.style.display = "none";
      retryBtn.remove();
      nextBtn.style.display = "";
      prevBtn.style.display = "";
    };

    funMsgEl.appendChild(retryBtn);
    nextBtn.style.display = "none";
    prevBtn.style.display = "none";
    showExplanationBtn.style.display = "none";
  }

  nextBtn.addEventListener("click", () => {
    if (userChoices[currentQuestion] === null || userChoices[currentQuestion] === undefined) return;
    if (!answered) return;
    if (currentQuestion < questions.length - 1) {
      currentQuestion++;
      loadQuestion();
    } else {
      showScore();
    }
  });

  prevBtn.addEventListener("click", () => {
    if (currentQuestion > 0) {
      currentQuestion--;
      loadQuestion();
    }
  });

  showExplanationBtn.addEventListener("click", () => {
    showExplanation();
  });

  shuffleQuestionsChoices();
  userChoices = Array(questionsOrig.length).fill(null);
  loadQuestion();
</script>
</body>
</html>
